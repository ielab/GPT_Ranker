training on google cloud TPU

export PROJECT_ID=project-id

gcloud config set project ${PROJECT_ID}

gcloud compute instances create gpt2-training \
--zone=us-central1-b \
--machine-type=n1-standard-2  \
--image-family=torch-xla \
--image-project=ml-images  \
--boot-disk-size=200GB \
--scopes=https://www.googleapis.com/auth/cloud-platform

gcloud compute ssh gpt2-training --zone=us-central1-b

gcloud compute tpus create gpt2-training \
--zone=us-central1-b \
--network=default \
--version=pytorch-1.6  \
--accelerator-type=v2-8

gcloud compute tpus list --zone=us-central1-b

conda activate torch-xla-1.6

export TPU_IP_ADDRESS=10.184.127.90

export XRT_TPU_CONFIG="tpu_worker;0;$TPU_IP_ADDRESS:8470"



Transfer files via Bucket:

gsutil cp gs://ielab-msmarco/args.json ./
gsutil cp gs://ielab-msmarco/train_GPT2.py ./